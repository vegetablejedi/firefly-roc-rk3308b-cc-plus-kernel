// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2018 Fuzhou Rockchip Electronics Co., Ltd
 */

/dts-v1/;

#include "rk3308-firefly.dtsi"
//#include "rk3308-mcu_3.5inch_ILI9486.dtsi"

/ {
	model = "Firefly RK3308 roc cc digital-pdm mic board";
	compatible = "firefly,rk3308-roc-cc-dmic-pdm_emmc", "firefly,rk3308";

	pdm_i2s_dais: pdm-i2s-dais {
		status = "okay";
		compatible = "rockchip,rk3308-multi-dais", "rockchip,multi-dais";
		dais = <&pdm_8ch>, <&i2s_8ch_2>;
		capture,channel-mapping = <6 2>;
		playback,channel-mapping = <0 2>;
		bitclock-inversion = <1 0>;
	};

	pdm-mic-array {
		status = "disabled";
		compatible = "simple-audio-card";
		simple-audio-card,name = "rockchip,pdm-mic-array";
		simple-audio-card,cpu {
			sound-dai = <&pdm_8ch>;
		};
		simple-audio-card,codec {
			sound-dai = <&dummy_codec>;
		};
	};

	vad-sound {
		status = "okay";
		compatible = "rockchip,multicodecs-card";
		rockchip,card-name = "rockchip,rk3308-vad";
		rockchip,cpu = <&pdm_i2s_dais>;
		rockchip,codec = <&acodec>, <&vad>;
	};

    leds {
        status = "okay";
        compatible = "gpio-leds";
        power {
            label = "firefly:red:power"; 
            linux,default-trigger = "ir-power-click";
            default-state = "on";
            gpios = <&gpio0 RK_PA6 GPIO_ACTIVE_HIGH>;
        };
        user {
            label = "firefly:blue:user";
            linux,default-trigger = "ir-user-click";
            default-state = "off";
            gpios = <&gpio0 RK_PB2 GPIO_ACTIVE_HIGH>;
        };
    };
};

&acodec_sound {
	status = "disabled";
};

&bluetooth_sound {
    status = "okay";
};

&i2s_2ch_0 {
    status = "okay";
    #sound-dai-cells = <0>;
    rockchip,clk-trcm = <1>;
};

&pdm_8ch {
	status = "okay";
	#sound-dai-cells = <0>;
	rockchip,no-dmaengine;
	pinctrl-names = "default";
	pinctrl-0 = <&pdm_m2_clk
		     &pdm_m2_clkm
		     &pdm_m2_sdi0
		     &pdm_m2_sdi1
		     &pdm_m2_sdi2
		     &pdm_m2_sdi3>;
};

&vad {
	status = "okay";
	rockchip,audio-src = <&pdm_8ch>;
	rockchip,det-channel = <0>;
	rockchip,mode = <1>;
	rockchip,buffer-time-ms = <200>;
	#sound-dai-cells = <0>;
};

&i2s_8ch_2 {
	status = "okay";
	rockchip,no-dmaengine;
	#sound-dai-cells = <0>;
};

&pdm_i2s_dais {
	status = "okay";
	#sound-dai-cells = <0>;
};

&emmc {
    status = "okay";
};

&nandc {
    status = "disabled";
};

&fiq_debugger {
    status = "okay";
    pinctrl-names = "default";
    pinctrl-0 = <&uart2m0_xfer>;
};

&sdmmc {
    status = "okay";
};

&vccio_sd {
    gpios = <&gpio0 RK_PA7 GPIO_ACTIVE_HIGH>;
};

&mac {
    status = "okay";
};

&vbus_host {
    status = "okay";
    enable-active-low;
};

&gpio_keys {
    status = "disabled";
};
